@page "/exerciseimages"
@page "/exerciseimages/{Username}"
@page "/exerciseimages/{Username}/{Detail?}"
@rendermode InteractiveServer
@using System.Net
@using Therapeasy.Model
@using System.Net.Http.Json
@using System.Text.Json
@using System.Text
@inject HttpClient HttpClient
@inject NavigationManager NavigationManager

<h4>My Exercise Images</h4>
<div>
@foreach (ExerciseImage img in exerciseImages)
{
    <ViewExerciseImage ExerciseImageId=@img.Id Detail=@Detail />
}
</div>

@code {
    [Parameter]
    public string Username { get; set; } = "";
    [Parameter]
    public string Detail { get; set; } = "nodetail";
    List<ExerciseImage> exerciseImages = new();
    Exercise exerciseImgToAdd = new();


    protected override async Task OnInitializedAsync()
    {
        await LoadExerciseImages();
    }

    private async Task LoadExerciseImages()
    {
        if (Username != "")
        {
          var result = await HttpClient.GetFromJsonAsync<List<ExerciseImage>>(NavigationManager.BaseUri + "plandb/get/exerciseimagesforuser/" + WebUtility.UrlEncode(Username));
          exerciseImages = result ?? new List<ExerciseImage>();
        }
    }
}